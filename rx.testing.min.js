/*** @preserve Copyright (c) Microsoft Corporation.  All rights reserved.
* This code is licensed by Microsoft Corporation under the terms
* of the MICROSOFT REACTIVE EXTENSIONS FOR JAVASCRIPT AND .NET LIBRARIES License.
* See http://go.microsoft.com/fwlink/?LinkID=220762.
*/
(function(e,t){var n=typeof exports=="object"&&exports&&(typeof e=="object"&&e&&e==e.global&&(window=e),exports);typeof define=="function"&&define.amd?define(["rx","exports"],function(n,r){return e.Rx=t(e,r,n),e.Rx}):typeof module=="object"&&module&&module.exports==n?module.exports=t(e,module.exports,require("./rx")):e.Rx=t(e,{},e.Rx)})(this,function(e,t,n,r){function v(e,t){return t.equals?t.equals(e):e===t}function m(e,t){return e.length===1&&Array.isArray(e[t])?e[t]:p.call(e)}function g(e){this.predicate=e}function y(e){this.predicate=e}var i=n.Observer,s=n.Observable,o=n.Notification,u=n.VirtualTimeScheduler,a=n.Disposable,f=a.empty,l=a.create,c=n.CompositeDisposable,h=n.SingleAssignmentDisposable,p=Array.prototype.slice,d=n.Internals.inherits;g.prototype.equals=function(e){return e===this?!0:e==null?!1:e.kind!=="N"?!1:this.predicate(e.value)},y.prototype.equals=function(e){return e===this?!0:e==null?!1:e.kind!=="E"?!1:this.predicate(e.exception)};var b=n.ReactiveTest={created:100,subscribed:200,disposed:1e3,onNext:function(e,t){return typeof t=="function"?new w(e,new g(t)):new w(e,o.createOnNext(t))},onError:function(e,t){return typeof t=="function"?new w(e,new y(t)):new w(e,o.createOnError(t))},onCompleted:function(e){return new w(e,o.createOnCompleted())},subscribe:function(e,t){return new E(e,t)}},w=n.Recorded=function(e,t,n){this.time=e,this.value=t,this.comparer=n||v};w.prototype.equals=function(e){return this.time===e.time&&this.comparer(this.value,e.value)},w.prototype.toString=function(){return this.value.toString()+"@"+this.time};var E=n.Subscription=function(e,t){this.subscribe=e,this.unsubscribe=t||Number.MAX_VALUE};E.prototype.equals=function(e){return this.subscribe===e.subscribe&&this.unsubscribe===e.unsubscribe},E.prototype.toString=function(){return"("+this.subscribe+", "+this.unsubscribe===Number.MAX_VALUE?"Infinite":this.unsubscribe+")"};var S=n.MockDisposable=function(e){this.scheduler=e,this.disposes=[],this.disposes.push(this.scheduler.clock)};S.prototype.dispose=function(){this.disposes.push(this.scheduler.clock)};var x=function(){function e(e){this.scheduler=e,this.messages=[]}return d(e,i),e.prototype.onNext=function(e){this.messages.push(new w(this.scheduler.clock,o.createOnNext(e)))},e.prototype.onError=function(e){this.messages.push(new w(this.scheduler.clock,o.createOnError(e)))},e.prototype.onCompleted=function(){this.messages.push(new w(this.scheduler.clock,o.createOnCompleted()))},e}(),T=function(){function e(e){var t=this;this.observers.push(e),this.subscriptions.push(new E(this.scheduler.clock));var n=this.subscriptions.length-1;return l(function(){var r=t.observers.indexOf(e);t.observers.splice(r,1),t.subscriptions[n]=new E(t.subscriptions[n].subscribe,t.scheduler.clock)})}function t(n,r){t.super_.constructor.call(this,e);var i,s,o=this;this.scheduler=n,this.messages=r,this.subscriptions=[],this.observers=[];for(var u=0,a=this.messages.length;u<a;u++)i=this.messages[u],s=i.value,function(e){n.scheduleAbsoluteWithState(null,i.time,function(){for(var t=0;t<o.observers.length;t++)e.accept(o.observers[t]);return f})}(s)}return d(t,s),t}(),N=function(){function e(e){var t,n,r=this;this.subscriptions.push(new E(this.scheduler.clock));var i=this.subscriptions.length-1,s=new c;for(var o=0,u=this.messages.length;o<u;o++)t=this.messages[o],n=t.value,function(n){s.add(r.scheduler.scheduleRelativeWithState(null,t.time,function(){return n.accept(e),f}))}(n);return l(function(){r.subscriptions[i]=new E(r.subscriptions[i].subscribe,r.scheduler.clock),s.dispose()})}function t(n,r){t.super_.constructor.call(this,e),this.scheduler=n,this.messages=r,this.subscriptions=[]}return d(t,s),t}();return n.TestScheduler=function(){function e(){e.super_.constructor.call(this,0,function(e,t){return e-t})}return d(e,u),e.prototype.scheduleAbsoluteWithState=function(t,n,r){return n<=this.clock&&(n=this.clock+1),e.super_.scheduleAbsoluteWithState.call(this,t,n,r)},e.prototype.add=function(e,t){return e+t},e.prototype.toDateTimeOffset=function(e){return(new Date(e)).getTime()},e.prototype.toRelative=function(e){return e},e.prototype.startWithTiming=function(e,t,n,r){var i=this.createObserver(),s,o;return this.scheduleAbsoluteWithState(null,t,function(){return s=e(),f}),this.scheduleAbsoluteWithState(null,n,function(){return o=s.subscribe(i),f}),this.scheduleAbsoluteWithState(null,r,function(){return o.dispose(),f}),this.start(),i},e.prototype.startWithDispose=function(e,t){return this.startWithTiming(e,b.created,b.subscribed,t)},e.prototype.startWithCreate=function(e){return this.startWithTiming(e,b.created,b.subscribed,b.disposed)},e.prototype.createHotObservable=function(){var e=m(arguments,0);return new T(this,e)},e.prototype.createColdObservable=function(){var e=m(arguments,0);return new N(this,e)},e.prototype.createObserver=function(){return new x(this)},e}(),n});